<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Recycling Classifier</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #e8efe6;
            background-image: url('https://i.imgur.com/4S7BqzC.png'); /* subtle paper texture */
            background-size: cover;
        }
        header {
            background: #3f5d47;
            color: white;
            padding: 25px;
            text-align: center;
            border-radius: 12px;
        }
        section {
            background: white;
            padding: 20px;
            margin-top: 20px;
            border-radius: 12px;
            box-shadow: 0 3px 6px rgba(0,0,0,0.15);
        }
        button {
            padding: 12px 22px;
            border: none;
            background: #4a7b57;
            color: white;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover { background: #436e50; }

        /* Loading animation */
        #loading-screen {
            display: none;
            text-align: center;
            padding: 20px;
            color: #3f5d47;
            font-size: 20px;
        }

        /* Pop-up tips */
        #tip-box {
            margin-top: 15px;
            padding: 15px;
            background: #f0f8f3;
            border-left: 5px solid #3f5d47;
            border-radius: 8px;
            display: none;
            font-size: 16px;
        }

        /* Class info cards */
        .cards {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }
        .card {
            background: #f7faf7;
            width: 180px;
            padding: 15px;
            text-align: center;
            border-radius: 12px;
            box-shadow: 0 3px 5px rgba(0,0,0,0.12);
        }
        .card img {
            width: 60px;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <header>
        <h1>Recycling Classifier</h1>
        <p>Glass â€¢ Recyclable Plastic â€¢ Trash</p>
    </header>

    <section>
        <h2>About This Project</h2>
        <p>This tool helps students and adults quickly determine whether an item is glass, recyclable plastic, or trash. Many people aren't sure how to sort waste correctly, which leads to contamination in recycling bins. This project makes recycling simpler and more environmentally friendly.</p>
    </section>

    <section>
        <h2>Recycling Categories</h2>
        <div class="cards">
            <div class="card">
                <img src="https://i.imgur.com/0oZ9j4O.png" />
                <h3>Glass</h3>
                <p>Bottles, jars, containers.</p>
            </div>
            <div class="card">
                <img src="https://i.imgur.com/NKp8pY9.png" />
                <h3>Recyclable Plastic</h3>
                <p>Water bottles, containers.</p>
            </div>
            <div class="card">
                <img src="https://i.imgur.com/gZ0O071.png" />
                <h3>Trash</h3>
                <p>Items that can't be recycled.</p>
            </div>
        </div>
    </section>

    <section>
        <h2>How to Use</h2>
        <ol>
            <li>Click the <strong>Start</strong> button below.</li>
            <li>Allow webcam access when asked.</li>
            <li>Hold your object up to the camera.</li>
            <li>Read the prediction and tip that appear.</li>
        </ol>

        <button type="button" onclick="init()">Start</button>
        <div id="loading-screen">ðŸŒ¿ Loading model... Please wait...</div>

        <div id="webcam-container"></div>
        <div id="label-container"></div>
        <div id="tip-box"></div>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js"></script>

    <script>
        const URL = "./my_model/";
        let model, webcam, labelContainer, maxPredictions;

        async function init() {
            document.getElementById("loading-screen").style.display = "block";

            const modelURL = URL + "model.json";
            const metadataURL = URL + "metadata.json";

            model = await tmImage.load(modelURL, metadataURL);
            maxPredictions = model.getTotalClasses();

            const flip = true;
            webcam = new tmImage.Webcam(200, 200, flip);
            await webcam.setup();
            await webcam.play();
            window.requestAnimationFrame(loop);

            document.getElementById("loading-screen").style.display = "none";
            document.getElementById("webcam-container").appendChild(webcam.canvas);

            labelContainer = document.getElementById("label-container");
            for (let i = 0; i < maxPredictions; i++) {
                labelContainer.appendChild(document.createElement("div"));
            }
        }

        function showTip(label) {
            const tipBox = document.getElementById("tip-box");
            let tip = "";

            if (label === "Glass") tip = "Rinse glass containers before recycling.";
            else if (label === "Recyclable Plastic") tip = "Most bottles and jugs are recyclableâ€”check for #1 or #2 symbols.";
            else if (label === "Trash") tip = "This item cannot be recycled in most areas.";

            tipBox.innerHTML = tip;
            tipBox.style.display = "block";
        }

        async function loop() {
            webcam.update();
            await predict();
            window.requestAnimationFrame(loop);
        }

        async function predict() {
            const prediction = await model.predict(webcam.canvas);

            let topClass = prediction[0].className;
            let topProb = prediction[0].probability;

            for (let i = 0; i < maxPredictions; i++) {
                if (prediction[i].probability > topProb) {
                    topClass = prediction[i].className;
                    topProb = prediction[i].probability;
                }
                labelContainer.childNodes[i].innerHTML = prediction[i].className + ": " + prediction[i].probability.toFixed(2);
            }

            showTip(topClass);
        }
    </script>
</body>
</html>
